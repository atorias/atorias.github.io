# 移动端布局

## 基本概念

### 屏幕尺寸

> 屏幕尺寸指的是以屏幕对角线的长度来计算的，单位是英寸。1英寸=2.54厘米

电子设备一般都用英寸来描述屏幕的物理大小，比如我们电脑常见的22、27英寸。英寸（inch，缩写为in）在荷兰语中的意思指的是大拇指，一英寸就是指普通人的拇指宽度。

### 像素pixel

> 从计算机技术的角度来解释，像素是硬件和软件所能控制的最小单位。它指显示屏的画面上表示出来的最小单位，不是图画上的最小单位。一幅图像通常包含成千上万个像素，每个像素都有自己的颜色信息，它们紧密地组合在一起。一个像素，就是一个点，或者说是一个很小的正方形。  

屏幕分辨率指一个屏幕具体由多少个像素点组成，单位是px。

#### css像素

css像素就是我们在进行开发时，经常使用的px单位。px本身从主观的意义来讲，其实应该是一个绝对单位，但是从客观的角度出发，在不同的机型下，他又相对于设备像素，主要体现在两个方面：

- 调整屏幕分辨率
- 两个不同型号的手机
- px会受到dpr（设备像素比）与ppi（每英寸像素比）的影响

#### 物理像素（设备像素 device pixels）pt

- 用于显示完整色彩的一个抽象“点”
- 不同设备物理像素点的大小不一样。  
- 常说的1920*1080像素分辨素就是指物理像素  
  
21英寸显示器的分辨率是1440x1080，5.8英寸的iPhone X的分辨率是2436×1125，我们用CSS画一条线，其长度是20px，如果都以物理像素作为度量单位，那么在显示器上看起来正常，在iPhone X屏幕上就变得非常小。

#### 逻辑像素（设备独立像素）Device Independent Pixel

代表可以通过程序控制使用的虚拟像素，是一个总的概念，包括了css像素。
一个设备独立像素里可能会包含1个或者多个物理像素点，包含的越多，画质越高。
为什么会出现设备独立像素这种虚拟像素单位概念呢？举个🌰：
假设，我有一个iPhone12 和 iPhone13，尺寸都是5.4，iphone12的分辨率是1040*960， iphone13的分辨率是2080×1170，那么，ihpone12有1170个物理像素，iphone有2532个物理像素。
如果按照真实物理像素进行布局，以12为例，那么到13上，又会出现一半的空白，为了避免这种情况的出现，出现了虚拟像素单位，我们统一12和13的虚拟像素都是1040个，只是在12上，1个虚拟像素被换算成1个物理像素，在13上，1个虚拟像素，被换算成2个物理像素。

#### dpr（设备像素比 device pixel ratio）

这种n个虚拟像素:n个物理像素比例式的换算，被统称为设备像素比，也就是dpr
当设备像素比为1:1时，使用1（1×1）个设备像素显示1个CSS像素；  
当设备像素比为2:1时，使用4（2×2）个设备像素显示1个CSS像素；  
当设备像素比为3:1时，使用9（3×3）个设备像素显示1个CSS像素。

`F12看到的手机设备的375x667` 就是逻辑像素 dip dp

#### ppi（pixel per inch）

- 每英寸像素，即每英寸所包含的像素点数目，也就是像素密度，数值越高，屏幕越能以更高的密度显示图像。  
- 它的计算公式为：PPI=√（X^2+Y^2）/ Z （X：长度像素数；Y：宽度像素数；Z：屏幕大小）
- ppi在120-160之间的手机被归为低密度手机，160-240被归为中密度，240-320被归为高密度，320以上被归为超高密度

## 视口viewport

设置

```html
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
```

viewport指的是视口，他是浏览器或app中webview显示页面的区域。一般来讲PC端的视口指的是浏览器窗口区域，而移动端就有点复杂，它有三个视口：

- **layout viewport**：布局视口
- **visual viewport**：视觉视口
- **ideal viewport**：理想视口

### 布局视口（layout viewport）

它是由浏览器提出的一种虚拟的布局视口，用来解决页面在手机上显示的问题。这种视口可以通过`<meta>`标签设置viewport来改变。移动设备上的浏览器都会把自己默认的viewport设为980px或1024px（也可能是其它值，这个是由设备自己决定的），但带来的后果就是浏览器会出现横向滚动条，因为浏览器可视区域的宽度是比这个默认的viewport的宽度要小的。

我们可以通过document.documentElement.clientWidth来获取布局视口大小

### 视觉视口（visual viewport）

它指的是浏览器的可视区域，也就是我们在移动端设备上能够看到的区域。默认与当前浏览器窗口大小相等，当用户对浏览器进行缩放时，不会改变布局视口的大小，但会改变视觉窗口的大小。  

我们可以通过window.innerWidth来获取视觉视口大小。

### 理想视口（ideal viewport）

理想中的视口。这个概念最早由苹果提出，其他浏览器厂商陆续跟进，目的是解决在布局视口下页面元素过小的问题，显示在理想视口中的页面具有最理想的宽度，用户无需进行缩放。所谓理想视口，即页面绘制区域可以完美适配设备宽度的视口大小，不需要出现滚动条即可正常查看网站的所有内容，且文字图片清晰，如所有iphone的理想视口宽度都为320px，安卓设备的理想视口有320px、360px等等。

### 总结

`当页面缩放比例为100%时，理想视口 = 视觉视口。`

我们可以通过screen.width来获取理想视口大小。

- width：该属性被用来控制视窗的宽度，可以将width设置为320这样确切的像素数，也可以设为这里需要注意的是viewport只对移动端浏览器有效，对PC端浏览器是无效的。这样的关键字，表示设备的实际宽度，一般为了自适应布局，普遍的做法是将width设置为device-width。
- height：该属性被用来控制视窗的高度，可以将height设置为640这样确切的像素数，也可以设为device-height这样的关键字，表示设备的实际高度，一般不会设置视窗的高度，这样内容超出的话采用滚动方式浏览。
- initial-scale：该属性用于指定页面的初始缩放比例，可以配置0.0～10的数字，initial-scale=1表示不进行缩放，视窗刚好等于理想视窗，当大于1时表示将视窗进行放大，小于1时表示缩小。这里只表示初始视窗缩放值，用户也可以自己进行缩放，例如双指拖动手势缩放或者双击手势放大。安卓设备上的initial-scale默认值： 无默认值，一定要设置，这个属性才会起作用。在iphone和ipad上，无论你给viewport设的宽的是多少，如果没有指定默认的缩放值，则iphone和ipad会自动计算这个缩放值，以达到当前页面不会出现横向滚动条(或者说viewport的宽度就是屏幕的宽度)的目的。
- maximum-scale：该属性表示用户能够手动放大的最大比例，可以配置0.0～10的数字。
- minimum-scale：该属性类似maximum-scale，用来指定页面缩小的最小比例。通常情况下，不会定义该属性的值，页面太小将难以浏览。
- user-scalable：该属性表示是否允许用户手动进行缩放，可配置no或者yes。当配置成no时，用户将不能通过手势操作的方式对页面进行缩放
- 这里需要注意的是viewport只对移动端浏览器有效，对PC端浏览器是无效的。
